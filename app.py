# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/10Y5GBVBYx_9h5S_52lrQKzzB4aKsay6U
"""

import streamlit as st
import pandas as pd
from nettoyage_voo import traiter_fichiers_utilisateur

st.set_page_config(page_title="Nettoyage VOO", layout="wide")

st.title("Analyse et nettoyage de donn√©es VOO")
fichiers = st.file_uploader("T√©l√©versez vos fichiers CSV (1 √† 4)", type=["csv"], accept_multiple_files=True)

if fichiers:
    st.success(f"{len(fichiers)} fichier(s) charg√©(s).")

    if st.button("Lancer l'analyse"):
        with st.spinner("Traitement en cours..."):
            base_nettoyee, erreurs, rapport_excel = traiter_fichiers_utilisateur(fichiers)

        st.subheader("‚úÖ Fichier nettoy√© : aper√ßu")
        st.dataframe(base_nettoyee.head())

        st.download_button("T√©l√©charger les donn√©es nettoy√©es", base_nettoyee.to_csv(index=False).encode('utf-8'),
                           file_name="donnees_nettoyees.csv", mime="text/csv")

        with open(rapport_excel, "rb") as f:
            st.download_button("üìë T√©l√©charger le rapport d‚Äôerreurs Excel", f, file_name=rapport_excel, mime="application/vnd.ms-excel")
