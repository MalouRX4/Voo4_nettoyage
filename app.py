# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/10Y5GBVBYx_9h5S_52lrQKzzB4aKsay6U
"""

import streamlit as st
import pandas as pd
from nettoyage_voo import traiter_fichiers_utilisateur

st.set_page_config(page_title="Nettoyage VOO", layout="wide")

st.title("ğŸ§ª Analyse et nettoyage de donnÃ©es VOO")
fichiers = st.file_uploader("TÃ©lÃ©versez vos fichiers CSV (1 Ã  4)", type=["csv"], accept_multiple_files=True)

if fichiers:
    st.success(f"{len(fichiers)} fichier(s) chargÃ©(s).")

    if st.button("ğŸš€ Lancer l'analyse"):
        with st.spinner("Traitement en cours..."):
            base_nettoyee, erreurs, rapport_excel = traiter_fichiers_utilisateur(fichiers)

        st.subheader("âœ… Fichier nettoyÃ© : aperÃ§u")
        st.dataframe(base_nettoyee.head())

        st.download_button("ğŸ“¥ TÃ©lÃ©charger les donnÃ©es nettoyÃ©es", base_nettoyee.to_csv(index=False).encode('utf-8'),
                           file_name="donnees_nettoyees.csv", mime="text/csv")

        with open(rapport_excel, "rb") as f:
            st.download_button("ğŸ“‘ TÃ©lÃ©charger le rapport dâ€™erreurs Excel", f, file_name=rapport_excel, mime="application/vnd.ms-excel")